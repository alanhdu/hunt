// Generated by CoffeeScript 1.7.1
(function() {
  var socket;

  socket = io.connect();

  socket.on("update", render);

  socket.on("error", function(msg) {
    return alert(msg);
  });

  $("#play").on("click", (function() {
    window.username = $("#username").val();
    socket.emit('begin', {
      width: 51,
      height: 23,
      username: username
    });
    return setInterval((function() {
      return requestUpdate();
    }), 150);
  }));

  $(window).keydown((function(evt) {
    var chr, direction, fire, key, type, username;
    if (evt.target.tagName.toLowerCase() === "input") {
      return true;
    }
    key = evt.which;
    chr = String.fromCharCode(key);
    switch (chr) {
      case 'J':
        direction = 'v';
        break;
      case 'K':
        direction = '^';
        break;
      case 'L':
        direction = '>';
        break;
      case 'H':
        direction = '<';
        break;
      case 'F':
        fire = True;
        break;
      default:
        return true;
    }
    evt.preventDefault();
    username = window.username;
    if (direction !== void 0) {
      if (evt.shiftKey) {
        type = "turn";
      } else {
        type = "move";
      }
      return socket.emit(type, {
        direction: direction,
        username: username
      });
    } else if (fire) {
      return socket.emit(fire, {
        username: username
      });
    }
  }));

}).call(this);
