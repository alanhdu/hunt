// Generated by CoffeeScript 1.7.1
(function() {
  var getType;

  this.render = function(arena) {
    var beginSpan, c, chr, height, i, map, width, x, y, _i, _len;
    arena += '\n';
    width = arena.indexOf('\n');
    height = (arena.length + 1) / (width + 1);
    console.log(arena);
    map = "";
    for (i = _i = 0, _len = arena.length; _i < _len; i = ++_i) {
      chr = arena[i];
      x = i % (width + 1);
      y = Math.floor(i / (width + 1));
      beginSpan = "<span id='" + x + "-" + y + "'>";
      switch (chr) {
        case '*':
          c = getType(x, y, width, arena);
          map += beginSpan + c + "</span>";
          break;
        case '\n':
          map += "<br />";
          break;
        case ' ':
          map += beginSpan + "&nbsp;" + "</span>";
          break;
        case '>':
          map += beginSpan + "&gt;" + "</span>";
          break;
        case '<':
          map += beginSpan + "&lt;" + "</span>";
          break;
        default:
          map += beginSpan + chr + "</span>";
      }
    }
    return (document.getElementById("map")).innerHTML = map;
  };

  getType = function(x, y, width, arena) {
    var bot, dash, left, pipe, pos, right, top, w;
    w = width + 1;
    pos = w * y + x;
    top = pos - w;
    bot = pos + w;
    left = pos - 1;
    right = pos + 1;
    if (arena[left] === '*' || arena[right] === '*') {
      dash = true;
    }
    if (arena[top] === '*' || arena[bot] === '*') {
      pipe = true;
    }
    if (arena[top] !== '*' && arena[bot] !== '*' && arena[left] !== '*' && arena[right] !== '*') {
      pipe = true;
      dash = true;
    }
    if (pipe && dash) {
      return '+';
    } else if (pipe) {
      return '|';
    } else if (dash) {
      return '-';
    } else {
      return ' ';
    }
  };

}).call(this);
